scoreboard players add @s RaycastTimer 1
execute unless block ~ ~ ~ air run scoreboard players set @s RaycastTimer 3333
execute if entity @e[distance=..2,type=!experience_orb,type=!area_effect_cloud,type=!armor_stand,type=!egg,type=!leash_knot,type=!trident,type=!painting,type=!#arrows,type=!snowball,type=!fireball,type=!small_fireball,type=!ender_pearl,type=!eye_of_ender,type=!experience_bottle,type=!item_frame,type=!item,type=!tnt,type=!falling_block,type=!firework_rocket,type=!shulker_bullet,type=!dragon_fireball,type=!evoker_fangs,type=!minecart,type=!chest_minecart,type=!furnace_minecart,type=!tnt_minecart,type=!hopper_minecart,type=!spawner_minecart,type=!llama_spit,tag=!Zed,tag=!InLabyrinth] run scoreboard players set @s RaycastTimer 2222

execute at @s[scores={RaycastTimer=2222}] run summon armor_stand ~ ~ ~ {Tags:["ultshadow"],DisabledSlots:2096896,Invisible:1,Invulnerable:1,ArmorItems:[{id:"minecraft:leather_boots",Count:1b,tag:{display:{color:0}}},{id:"minecraft:leather_leggings",Count:1b,tag:{display:{color:0}}},{id:"minecraft:leather_chestplate",Count:1b,tag:{display:{color:0}}},{id:"minecraft:player_head",Count:1b,tag:{display:{Name:"{\"text\":\"Zed\"}"},SkullOwner:{Id:[I;844911766,-109258656,-790211895,-1250175385],Properties:{textures:[{Value:"eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvZTU1NGEzMTQ2MWZhOTBiNmE3Y2ZjZmRmN2IxNzE2MTg5Y2YzZTdiMTczNDQ0ODg1NmU5YmFhZTc0ZTQ1In19fQ=="}]}}}}]}
execute as @s[scores={RaycastTimer=2222}] run effect give @s resistance 1 9 true
execute as @s[scores={RaycastTimer=2222}] run tag @s remove ZedNoSwitch2
execute as @s[scores={RaycastTimer=2222}] run playsound minecraft:entity.ender_dragon.shoot neutral @a[distance=..30] ~ ~ ~ 10 0 1
execute at @s[scores={RaycastTimer=2222}] run particle minecraft:dust 2 0 0 1 ~ ~ ~ 0.5 1.3 0.5 0 100
execute at @s[scores={RaycastTimer=2222}] run particle minecraft:smoke ~ ~ ~ 0.5 1.3 0.5 0 100
execute as @s[scores={RaycastTimer=2222}] positioned ^ ^ ^ run tp @s @e[limit=1,sort=nearest,type=!experience_orb,type=!area_effect_cloud,type=!armor_stand,type=!egg,type=!leash_knot,type=!trident,type=!painting,type=!#arrows,type=!snowball,type=!fireball,type=!small_fireball,type=!ender_pearl,type=!eye_of_ender,type=!experience_bottle,type=!item_frame,type=!item,type=!tnt,type=!falling_block,type=!firework_rocket,type=!shulker_bullet,type=!dragon_fireball,type=!evoker_fangs,type=!minecart,type=!chest_minecart,type=!furnace_minecart,type=!tnt_minecart,type=!hopper_minecart,type=!spawner_minecart,type=!llama_spit,tag=!Zed,tag=!InLabyrinth]
execute as @s[scores={RaycastTimer=2222}] positioned ^ ^ ^ run particle minecraft:smoke ~ ~ ~ 1 1 1 1 1000
execute as @s[scores={RaycastTimer=2222}] positioned ^ ^ ^ run tag @e[limit=1,sort=nearest,type=!experience_orb,type=!area_effect_cloud,type=!armor_stand,type=!egg,type=!leash_knot,type=!trident,type=!painting,type=!#arrows,type=!snowball,type=!fireball,type=!small_fireball,type=!ender_pearl,type=!eye_of_ender,type=!experience_bottle,type=!item_frame,type=!item,type=!tnt,type=!falling_block,type=!firework_rocket,type=!shulker_bullet,type=!dragon_fireball,type=!evoker_fangs,type=!minecart,type=!chest_minecart,type=!furnace_minecart,type=!tnt_minecart,type=!hopper_minecart,type=!spawner_minecart,type=!llama_spit,tag=!Zed,tag=!InLabyrinth] add ZedDeathmarked
execute as @s[scores={RaycastTimer=2222}] run scoreboard players set @s Ability4CD 0

execute as @s[scores={RaycastTimer=..30}] positioned ^ ^ ^0.5 run function datapack:zed_functions/zedpassive3